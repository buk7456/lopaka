each decl in declarations 
    if decl.type == 'bitmap'
        | static const unsigned char PROGMEM !{decl.data.name}[] = {!{decl.data.value}};
        |
    else 
        | !{decl}
        |
if settings.wrap
    | void draw(void) {
- var textColor = ''
- var textSize = ''
- var textWrap = true
| display.einkOn();
|
each layer in layers 
    case layer.type
        when 'dot'
            | @!{layer.uid};display.drawPixel(!{layer.position[0]}, !{layer.position[1]}, !{packColor(layer.color)});
        when 'line'
            | @!{layer.uid};display.drawLine(!{layer.p1[0]}, !{layer.p1[1]}, !{layer.p2[0]}, !{layer.p2[1]}, !{packColor(layer.color)});
        when 'rect'
            - var func = layer.fill ? 'fillRect' : 'drawRect'
            | @!{layer.uid};display.!{func}(!{layer.position[0]}, !{layer.position[1]}, !{layer.size[0]}, !{layer.size[1]}, !{packColor(layer.color)});
        when 'circle'
            - var func = layer.fill ? 'fillCircle' : 'drawCircle'
            | @!{layer.uid};display.!{func}(!{layer.position[0] + layer.radius}, !{layer.position[1] + layer.radius}, !{layer.radius}, !{packColor(layer.color)});
        when 'string'
            if layer.color != textColor
                - textColor = layer.color
                | display.setTextColor(!{packColor(layer.color)});
                |
            if layer.scaleFactor != textSize
                - textSize = layer.scaleFactor
                | display.setTextSize(!{layer.scaleFactor});
                |
            if layer.wrap != textWrap
                - textWrap = layer.wrap
                | display.setTextWrap(false);
                |
            | display.setCursor(!{layer.position[0]}, !{layer.position[1] - layer.bounds[3]});
            | @!{layer.uid};display.print("!{layer.text}");
        when 'paint'
        when 'icon'
            | @!{layer.uid};display.drawBitmap(!{layer.position[0]}, !{layer.position[1]}, !{layer.imageName}, !{layer.size[0]}, !{layer.size[1]}, !{packColor(layer.color)});
        default 
            |
            | // Unknown layer type !{layer.type}
            |
    |
    |
| display.einkOff();
if settings.wrap
    | }
